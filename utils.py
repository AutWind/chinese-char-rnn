# -*- coding: utf-8 -*-

import os
import re
import codecs
import collections
import cPickle
from random import shuffle
import glob
import numpy as np
import sys
import progressbar as pb

PAD = "_PAD"
GO = "_GO"
EOS = "_EOS"
UNK = "_UNK"
SPACE = " "
NEW_LINE = "\n"
START_VOCAB = [PAD, GO, EOS, UNK, SPACE, NEW_LINE]

def normalizeUnicode(text):
  t = {u"\u00A8": u"\u0020\u0308",
       u"\u00AF": u"\u0020\u0304",
       u"\u00B4": u"\u0020\u0301",
       u"\u00B5": u"\u03BC",
       u"\u00B8": u"\u0020\u0327",
       u"\u0132": u"\u0049\u004A",
       u"\u0133": u"\u0069\u006A",
       u"\u013F": u"\u004C\u00B7",
       u"\u0140": u"\u006C\u00B7",
       u"\u0149": u"\u02BC\u006E",
       u"\u017F": u"\u0073",
       u"\u01C4": u"\u0044\u017D",
       u"\u01C5": u"\u0044\u017E",
       u"\u01C6": u"\u0064\u017E",
       u"\u01C7": u"\u004C\u004A",
       u"\u01C8": u"\u004C\u006A",
       u"\u01C9": u"\u006C\u006A",
       u"\u01CA": u"\u004E\u004A",
       u"\u01CB": u"\u004E\u006A",
       u"\u01CC": u"\u006E\u006A",
       u"\u01F1": u"\u0044\u005A",
       u"\u01F2": u"\u0044\u007A",
       u"\u01F3": u"\u0064\u007A",
       u"\u02D8": u"\u0020\u0306",
       u"\u02D9": u"\u0020\u0307",
       u"\u02DA": u"\u0020\u030A",
       u"\u02DB": u"\u0020\u0328",
       u"\u02DC": u"\u0020\u0303",
       u"\u02DD": u"\u0020\u030B",
       u"\u037A": u"\u0020\u0345",
       u"\u0384": u"\u0020\u0301",
       u"\u03D0": u"\u03B2",
       u"\u03D1": u"\u03B8",
       u"\u03D2": u"\u03A5",
       u"\u03D5": u"\u03C6",
       u"\u03D6": u"\u03C0",
       u"\u03F0": u"\u03BA",
       u"\u03F1": u"\u03C1",
       u"\u03F2": u"\u03C2",
       u"\u03F4": u"\u0398",
       u"\u03F5": u"\u03B5",
       u"\u03F9": u"\u03A3",
       u"\u0587": u"\u0565\u0582",
       u"\u0675": u"\u0627\u0674",
       u"\u0676": u"\u0648\u0674",
       u"\u0677": u"\u06C7\u0674",
       u"\u0678": u"\u064A\u0674",
       u"\u0E33": u"\u0E4D\u0E32",
       u"\u0EB3": u"\u0ECD\u0EB2",
       u"\u0EDC": u"\u0EAB\u0E99",
       u"\u0EDD": u"\u0EAB\u0EA1",
       u"\u0F77": u"\u0FB2\u0F81",
       u"\u0F79": u"\u0FB3\u0F81",
       u"\u1E9A": u"\u0061\u02BE",
       u"\u1FBD": u"\u0020\u0313",
       u"\u1FBF": u"\u0020\u0313",
       u"\u1FC0": u"\u0020\u0342",
       u"\u1FFE": u"\u0020\u0314",
       u"\u2002": u"\u0020",
       u"\u2003": u"\u0020",
       u"\u2004": u"\u0020",
       u"\u2005": u"\u0020",
       u"\u2006": u"\u0020",
       u"\u2008": u"\u0020",
       u"\u2009": u"\u0020",
       u"\u200A": u"\u0020",
       u"\u2017": u"\u0020\u0333",
       u"\u2024": u"\u002E",
       u"\u2025": u"\u002E\u002E",
       u"\u2026": u"\u002E\u002E\u002E",
       u"\u2033": u"\u2032\u2032",
       u"\u2034": u"\u2032\u2032\u2032",
       u"\u2036": u"\u2035\u2035",
       u"\u2037": u"\u2035\u2035\u2035",
       u"\u203C": u"\u0021\u0021",
       u"\u203E": u"\u0020\u0305",
       u"\u2047": u"\u003F\u003F",
       u"\u2048": u"\u003F\u0021",
       u"\u2049": u"\u0021\u003F",
       u"\u2057": u"\u2032\u2032\u2032\u2032",
       u"\u205F": u"\u0020",
       u"\u20A8": u"\u0052\u0073",
       u"\u2100": u"\u0061\u002F\u0063",
       u"\u2101": u"\u0061\u002F\u0073",
       u"\u2103": u"\u00B0\u0043",
       u"\u2105": u"\u0063\u002F\u006F",
       u"\u2106": u"\u0063\u002F\u0075",
       u"\u2107": u"\u0190",
       u"\u2109": u"\u00B0\u0046",
       u"\u2116": u"\u004E\u006F",
       u"\u2121": u"\u0054\u0045\u004C",
       u"\u2135": u"\u05D0",
       u"\u2136": u"\u05D1",
       u"\u2137": u"\u05D2",
       u"\u2138": u"\u05D3",
       u"\u213B": u"\u0046\u0041\u0058",
       u"\u2160": u"\u0049",
       u"\u2161": u"\u0049\u0049",
       u"\u2162": u"\u0049\u0049\u0049",
       u"\u2163": u"\u0049\u0056",
       u"\u2164": u"\u0056",
       u"\u2165": u"\u0056\u0049",
       u"\u2166": u"\u0056\u0049\u0049",
       u"\u2167": u"\u0056\u0049\u0049\u0049",
       u"\u2168": u"\u0049\u0058",
       u"\u2169": u"\u0058",
       u"\u216A": u"\u0058\u0049",
       u"\u216B": u"\u0058\u0049\u0049",
       u"\u216C": u"\u004C",
       u"\u216D": u"\u0043",
       u"\u216E": u"\u0044",
       u"\u216F": u"\u004D",
       u"\u2170": u"\u0069",
       u"\u2171": u"\u0069\u0069",
       u"\u2172": u"\u0069\u0069\u0069",
       u"\u2173": u"\u0069\u0076",
       u"\u2174": u"\u0076",
       u"\u2175": u"\u0076\u0069",
       u"\u2176": u"\u0076\u0069\u0069",
       u"\u2177": u"\u0076\u0069\u0069\u0069",
       u"\u2178": u"\u0069\u0078",
       u"\u2179": u"\u0078",
       u"\u217A": u"\u0078\u0069",
       u"\u217B": u"\u0078\u0069\u0069",
       u"\u217C": u"\u006C",
       u"\u217D": u"\u0063",
       u"\u217E": u"\u0064",
       u"\u217F": u"\u006D",
       u"\u222C": u"\u222B\u222B",
       u"\u222D": u"\u222B\u222B\u222B",
       u"\u222F": u"\u222E\u222E",
       u"\u2230": u"\u222E\u222E\u222E",
       u"\u2474": u"\u0028\u0031\u0029",
       u"\u2475": u"\u0028\u0032\u0029",
       u"\u2476": u"\u0028\u0033\u0029",
       u"\u2477": u"\u0028\u0034\u0029",
       u"\u2478": u"\u0028\u0035\u0029",
       u"\u2479": u"\u0028\u0036\u0029",
       u"\u247A": u"\u0028\u0037\u0029",
       u"\u247B": u"\u0028\u0038\u0029",
       u"\u247C": u"\u0028\u0039\u0029",
       u"\u247D": u"\u0028\u0031\u0030\u0029",
       u"\u247E": u"\u0028\u0031\u0031\u0029",
       u"\u247F": u"\u0028\u0031\u0032\u0029",
       u"\u2480": u"\u0028\u0031\u0033\u0029",
       u"\u2481": u"\u0028\u0031\u0034\u0029",
       u"\u2482": u"\u0028\u0031\u0035\u0029",
       u"\u2483": u"\u0028\u0031\u0036\u0029",
       u"\u2484": u"\u0028\u0031\u0037\u0029",
       u"\u2485": u"\u0028\u0031\u0038\u0029",
       u"\u2486": u"\u0028\u0031\u0039\u0029",
       u"\u2487": u"\u0028\u0032\u0030\u0029",
       u"\u2488": u"\u0031\u002E",
       u"\u2489": u"\u0032\u002E",
       u"\u248A": u"\u0033\u002E",
       u"\u248B": u"\u0034\u002E",
       u"\u248C": u"\u0035\u002E",
       u"\u248D": u"\u0036\u002E",
       u"\u248E": u"\u0037\u002E",
       u"\u248F": u"\u0038\u002E",
       u"\u2490": u"\u0039\u002E",
       u"\u2491": u"\u0031\u0030\u002E",
       u"\u2492": u"\u0031\u0031\u002E",
       u"\u2493": u"\u0031\u0032\u002E",
       u"\u2494": u"\u0031\u0033\u002E",
       u"\u2495": u"\u0031\u0034\u002E",
       u"\u2496": u"\u0031\u0035\u002E",
       u"\u2497": u"\u0031\u0036\u002E",
       u"\u2498": u"\u0031\u0037\u002E",
       u"\u2499": u"\u0031\u0038\u002E",
       u"\u249A": u"\u0031\u0039\u002E",
       u"\u249B": u"\u0032\u0030\u002E",
       u"\u249C": u"\u0028\u0061\u0029",
       u"\u249D": u"\u0028\u0062\u0029",
       u"\u249E": u"\u0028\u0063\u0029",
       u"\u249F": u"\u0028\u0064\u0029",
       u"\u24A0": u"\u0028\u0065\u0029",
       u"\u24A1": u"\u0028\u0066\u0029",
       u"\u24A2": u"\u0028\u0067\u0029",
       u"\u24A3": u"\u0028\u0068\u0029",
       u"\u24A4": u"\u0028\u0069\u0029",
       u"\u24A5": u"\u0028\u006A\u0029",
       u"\u24A6": u"\u0028\u006B\u0029",
       u"\u24A7": u"\u0028\u006C\u0029",
       u"\u24A8": u"\u0028\u006D\u0029",
       u"\u24A9": u"\u0028\u006E\u0029",
       u"\u24AA": u"\u0028\u006F\u0029",
       u"\u24AB": u"\u0028\u0070\u0029",
       u"\u24AC": u"\u0028\u0071\u0029",
       u"\u24AD": u"\u0028\u0072\u0029",
       u"\u24AE": u"\u0028\u0073\u0029",
       u"\u24AF": u"\u0028\u0074\u0029",
       u"\u24B0": u"\u0028\u0075\u0029",
       u"\u24B1": u"\u0028\u0076\u0029",
       u"\u24B2": u"\u0028\u0077\u0029",
       u"\u24B3": u"\u0028\u0078\u0029",
       u"\u24B4": u"\u0028\u0079\u0029",
       u"\u24B5": u"\u0028\u007A\u0029",
       u"\u2A0C": u"\u222B\u222B\u222B\u222B",
       u"\u2A74": u"\u003A\u003A\u003D",
       u"\u2A75": u"\u003D\u003D",
       u"\u2A76": u"\u003D\u003D\u003D",
       u"\u2E9F": u"\u6BCD",
       u"\u2EF3": u"\u9F9F",
       u"\u2F00": u"\u4E00",
       u"\u2F01": u"\u4E28",
       u"\u2F02": u"\u4E36",
       u"\u2F03": u"\u4E3F",
       u"\u2F04": u"\u4E59",
       u"\u2F05": u"\u4E85",
       u"\u2F06": u"\u4E8C",
       u"\u2F07": u"\u4EA0",
       u"\u2F08": u"\u4EBA",
       u"\u2F09": u"\u513F",
       u"\u2F0A": u"\u5165",
       u"\u2F0B": u"\u516B",
       u"\u2F0C": u"\u5182",
       u"\u2F0D": u"\u5196",
       u"\u2F0E": u"\u51AB",
       u"\u2F0F": u"\u51E0",
       u"\u2F10": u"\u51F5",
       u"\u2F11": u"\u5200",
       u"\u2F12": u"\u529B",
       u"\u2F13": u"\u52F9",
       u"\u2F14": u"\u5315",
       u"\u2F15": u"\u531A",
       u"\u2F16": u"\u5338",
       u"\u2F17": u"\u5341",
       u"\u2F18": u"\u535C",
       u"\u2F19": u"\u5369",
       u"\u2F1A": u"\u5382",
       u"\u2F1B": u"\u53B6",
       u"\u2F1C": u"\u53C8",
       u"\u2F1D": u"\u53E3",
       u"\u2F1E": u"\u56D7",
       u"\u2F1F": u"\u571F",
       u"\u2F20": u"\u58EB",
       u"\u2F21": u"\u5902",
       u"\u2F22": u"\u590A",
       u"\u2F23": u"\u5915",
       u"\u2F24": u"\u5927",
       u"\u2F25": u"\u5973",
       u"\u2F26": u"\u5B50",
       u"\u2F27": u"\u5B80",
       u"\u2F28": u"\u5BF8",
       u"\u2F29": u"\u5C0F",
       u"\u2F2A": u"\u5C22",
       u"\u2F2B": u"\u5C38",
       u"\u2F2C": u"\u5C6E",
       u"\u2F2D": u"\u5C71",
       u"\u2F2E": u"\u5DDB",
       u"\u2F2F": u"\u5DE5",
       u"\u2F30": u"\u5DF1",
       u"\u2F31": u"\u5DFE",
       u"\u2F32": u"\u5E72",
       u"\u2F33": u"\u5E7A",
       u"\u2F34": u"\u5E7F",
       u"\u2F35": u"\u5EF4",
       u"\u2F36": u"\u5EFE",
       u"\u2F37": u"\u5F0B",
       u"\u2F38": u"\u5F13",
       u"\u2F39": u"\u5F50",
       u"\u2F3A": u"\u5F61",
       u"\u2F3B": u"\u5F73",
       u"\u2F3C": u"\u5FC3",
       u"\u2F3D": u"\u6208",
       u"\u2F3E": u"\u6236",
       u"\u2F3F": u"\u624B",
       u"\u2F40": u"\u652F",
       u"\u2F41": u"\u6534",
       u"\u2F42": u"\u6587",
       u"\u2F43": u"\u6597",
       u"\u2F44": u"\u65A4",
       u"\u2F45": u"\u65B9",
       u"\u2F46": u"\u65E0",
       u"\u2F47": u"\u65E5",
       u"\u2F48": u"\u66F0",
       u"\u2F49": u"\u6708",
       u"\u2F4A": u"\u6728",
       u"\u2F4B": u"\u6B20",
       u"\u2F4C": u"\u6B62",
       u"\u2F4D": u"\u6B79",
       u"\u2F4E": u"\u6BB3",
       u"\u2F4F": u"\u6BCB",
       u"\u2F50": u"\u6BD4",
       u"\u2F51": u"\u6BDB",
       u"\u2F52": u"\u6C0F",
       u"\u2F53": u"\u6C14",
       u"\u2F54": u"\u6C34",
       u"\u2F55": u"\u706B",
       u"\u2F56": u"\u722A",
       u"\u2F57": u"\u7236",
       u"\u2F58": u"\u723B",
       u"\u2F59": u"\u723F",
       u"\u2F5A": u"\u7247",
       u"\u2F5B": u"\u7259",
       u"\u2F5C": u"\u725B",
       u"\u2F5D": u"\u72AC",
       u"\u2F5E": u"\u7384",
       u"\u2F5F": u"\u7389",
       u"\u2F60": u"\u74DC",
       u"\u2F61": u"\u74E6",
       u"\u2F62": u"\u7518",
       u"\u2F63": u"\u751F",
       u"\u2F64": u"\u7528",
       u"\u2F65": u"\u7530",
       u"\u2F66": u"\u758B",
       u"\u2F67": u"\u7592",
       u"\u2F68": u"\u7676",
       u"\u2F69": u"\u767D",
       u"\u2F6A": u"\u76AE",
       u"\u2F6B": u"\u76BF",
       u"\u2F6C": u"\u76EE",
       u"\u2F6D": u"\u77DB",
       u"\u2F6E": u"\u77E2",
       u"\u2F6F": u"\u77F3",
       u"\u2F70": u"\u793A",
       u"\u2F71": u"\u79B8",
       u"\u2F72": u"\u79BE",
       u"\u2F73": u"\u7A74",
       u"\u2F74": u"\u7ACB",
       u"\u2F75": u"\u7AF9",
       u"\u2F76": u"\u7C73",
       u"\u2F77": u"\u7CF8",
       u"\u2F78": u"\u7F36",
       u"\u2F79": u"\u7F51",
       u"\u2F7A": u"\u7F8A",
       u"\u2F7B": u"\u7FBD",
       u"\u2F7C": u"\u8001",
       u"\u2F7D": u"\u800C",
       u"\u2F7E": u"\u8012",
       u"\u2F7F": u"\u8033",
       u"\u2F80": u"\u807F",
       u"\u2F81": u"\u8089",
       u"\u2F82": u"\u81E3",
       u"\u2F83": u"\u81EA",
       u"\u2F84": u"\u81F3",
       u"\u2F85": u"\u81FC",
       u"\u2F86": u"\u820C",
       u"\u2F87": u"\u821B",
       u"\u2F88": u"\u821F",
       u"\u2F89": u"\u826E",
       u"\u2F8A": u"\u8272",
       u"\u2F8B": u"\u8278",
       u"\u2F8C": u"\u864D",
       u"\u2F8D": u"\u866B",
       u"\u2F8E": u"\u8840",
       u"\u2F8F": u"\u884C",
       u"\u2F90": u"\u8863",
       u"\u2F91": u"\u897E",
       u"\u2F92": u"\u898B",
       u"\u2F93": u"\u89D2",
       u"\u2F94": u"\u8A00",
       u"\u2F95": u"\u8C37",
       u"\u2F96": u"\u8C46",
       u"\u2F97": u"\u8C55",
       u"\u2F98": u"\u8C78",
       u"\u2F99": u"\u8C9D",
       u"\u2F9A": u"\u8D64",
       u"\u2F9B": u"\u8D70",
       u"\u2F9C": u"\u8DB3",
       u"\u2F9D": u"\u8EAB",
       u"\u2F9E": u"\u8ECA",
       u"\u2F9F": u"\u8F9B",
       u"\u2FA0": u"\u8FB0",
       u"\u2FA1": u"\u8FB5",
       u"\u2FA2": u"\u9091",
       u"\u2FA3": u"\u9149",
       u"\u2FA4": u"\u91C6",
       u"\u2FA5": u"\u91CC",
       u"\u2FA6": u"\u91D1",
       u"\u2FA7": u"\u9577",
       u"\u2FA8": u"\u9580",
       u"\u2FA9": u"\u961C",
       u"\u2FAA": u"\u96B6",
       u"\u2FAB": u"\u96B9",
       u"\u2FAC": u"\u96E8",
       u"\u2FAD": u"\u9751",
       u"\u2FAE": u"\u975E",
       u"\u2FAF": u"\u9762",
       u"\u2FB0": u"\u9769",
       u"\u2FB1": u"\u97CB",
       u"\u2FB2": u"\u97ED",
       u"\u2FB3": u"\u97F3",
       u"\u2FB4": u"\u9801",
       u"\u2FB5": u"\u98A8",
       u"\u2FB6": u"\u98DB",
       u"\u2FB7": u"\u98DF",
       u"\u2FB8": u"\u9996",
       u"\u2FB9": u"\u9999",
       u"\u2FBA": u"\u99AC",
       u"\u2FBB": u"\u9AA8",
       u"\u2FBC": u"\u9AD8",
       u"\u2FBD": u"\u9ADF",
       u"\u2FBE": u"\u9B25",
       u"\u2FBF": u"\u9B2F",
       u"\u2FC0": u"\u9B32",
       u"\u2FC1": u"\u9B3C",
       u"\u2FC2": u"\u9B5A",
       u"\u2FC3": u"\u9CE5",
       u"\u2FC4": u"\u9E75",
       u"\u2FC5": u"\u9E7F",
       u"\u2FC6": u"\u9EA5",
       u"\u2FC7": u"\u9EBB",
       u"\u2FC8": u"\u9EC3",
       u"\u2FC9": u"\u9ECD",
       u"\u2FCA": u"\u9ED1",
       u"\u2FCB": u"\u9EF9",
       u"\u2FCC": u"\u9EFD",
       u"\u2FCD": u"\u9F0E",
       u"\u2FCE": u"\u9F13",
       u"\u2FCF": u"\u9F20",
       u"\u2FD0": u"\u9F3B",
       u"\u2FD1": u"\u9F4A",
       u"\u2FD2": u"\u9F52",
       u"\u2FD3": u"\u9F8D",
       u"\u2FD4": u"\u9F9C",
       u"\u2FD5": u"\u9FA0",
       u"\u3036": u"\u3012",
       u"\u3038": u"\u5341",
       u"\u3039": u"\u5344",
       u"\u303A": u"\u5345",
       u"\u309B": u"\u0020\u3099",
       u"\u309C": u"\u0020\u309A",
       u"\u3131": u"\u1100",
       u"\u3132": u"\u1101",
       u"\u3133": u"\u11AA",
       u"\u3134": u"\u1102",
       u"\u3135": u"\u11AC",
       u"\u3136": u"\u11AD",
       u"\u3137": u"\u1103",
       u"\u3138": u"\u1104",
       u"\u3139": u"\u1105",
       u"\u313A": u"\u11B0",
       u"\u313B": u"\u11B1",
       u"\u313C": u"\u11B2",
       u"\u313D": u"\u11B3",
       u"\u313E": u"\u11B4",
       u"\u313F": u"\u11B5",
       u"\u3140": u"\u111A",
       u"\u3141": u"\u1106",
       u"\u3142": u"\u1107",
       u"\u3143": u"\u1108",
       u"\u3144": u"\u1121",
       u"\u3145": u"\u1109",
       u"\u3146": u"\u110A",
       u"\u3147": u"\u110B",
       u"\u3148": u"\u110C",
       u"\u3149": u"\u110D",
       u"\u314A": u"\u110E",
       u"\u314B": u"\u110F",
       u"\u314C": u"\u1110",
       u"\u314D": u"\u1111",
       u"\u314E": u"\u1112",
       u"\u314F": u"\u1161",
       u"\u3150": u"\u1162",
       u"\u3151": u"\u1163",
       u"\u3152": u"\u1164",
       u"\u3153": u"\u1165",
       u"\u3154": u"\u1166",
       u"\u3155": u"\u1167",
       u"\u3156": u"\u1168",
       u"\u3157": u"\u1169",
       u"\u3158": u"\u116A",
       u"\u3159": u"\u116B",
       u"\u315A": u"\u116C",
       u"\u315B": u"\u116D",
       u"\u315C": u"\u116E",
       u"\u315D": u"\u116F",
       u"\u315E": u"\u1170",
       u"\u315F": u"\u1171",
       u"\u3160": u"\u1172",
       u"\u3161": u"\u1173",
       u"\u3162": u"\u1174",
       u"\u3163": u"\u1175",
       u"\u3164": u"\u1160",
       u"\u3165": u"\u1114",
       u"\u3166": u"\u1115",
       u"\u3167": u"\u11C7",
       u"\u3168": u"\u11C8",
       u"\u3169": u"\u11CC",
       u"\u316A": u"\u11CE",
       u"\u316B": u"\u11D3",
       u"\u316C": u"\u11D7",
       u"\u316D": u"\u11D9",
       u"\u316E": u"\u111C",
       u"\u316F": u"\u11DD",
       u"\u3170": u"\u11DF",
       u"\u3171": u"\u111D",
       u"\u3172": u"\u111E",
       u"\u3173": u"\u1120",
       u"\u3174": u"\u1122",
       u"\u3175": u"\u1123",
       u"\u3176": u"\u1127",
       u"\u3177": u"\u1129",
       u"\u3178": u"\u112B",
       u"\u3179": u"\u112C",
       u"\u317A": u"\u112D",
       u"\u317B": u"\u112E",
       u"\u317C": u"\u112F",
       u"\u317D": u"\u1132",
       u"\u317E": u"\u1136",
       u"\u317F": u"\u1140",
       u"\u3180": u"\u1147",
       u"\u3181": u"\u114C",
       u"\u3182": u"\u11F1",
       u"\u3183": u"\u11F2",
       u"\u3184": u"\u1157",
       u"\u3185": u"\u1158",
       u"\u3186": u"\u1159",
       u"\u3187": u"\u1184",
       u"\u3188": u"\u1185",
       u"\u3189": u"\u1188",
       u"\u318A": u"\u1191",
       u"\u318B": u"\u1192",
       u"\u318C": u"\u1194",
       u"\u318D": u"\u119E",
       u"\u318E": u"\u11A1",
       u"\u3200": u"\u0028\u1100\u0029",
       u"\u3201": u"\u0028\u1102\u0029",
       u"\u3202": u"\u0028\u1103\u0029",
       u"\u3203": u"\u0028\u1105\u0029",
       u"\u3204": u"\u0028\u1106\u0029",
       u"\u3205": u"\u0028\u1107\u0029",
       u"\u3206": u"\u0028\u1109\u0029",
       u"\u3207": u"\u0028\u110B\u0029",
       u"\u3208": u"\u0028\u110C\u0029",
       u"\u3209": u"\u0028\u110E\u0029",
       u"\u320A": u"\u0028\u110F\u0029",
       u"\u320B": u"\u0028\u1110\u0029",
       u"\u320C": u"\u0028\u1111\u0029",
       u"\u320D": u"\u0028\u1112\u0029",
       u"\u320E": u"\u0028\u1100\u1161\u0029",
       u"\u320F": u"\u0028\u1102\u1161\u0029",
       u"\u3210": u"\u0028\u1103\u1161\u0029",
       u"\u3211": u"\u0028\u1105\u1161\u0029",
       u"\u3212": u"\u0028\u1106\u1161\u0029",
       u"\u3213": u"\u0028\u1107\u1161\u0029",
       u"\u3214": u"\u0028\u1109\u1161\u0029",
       u"\u3215": u"\u0028\u110B\u1161\u0029",
       u"\u3216": u"\u0028\u110C\u1161\u0029",
       u"\u3217": u"\u0028\u110E\u1161\u0029",
       u"\u3218": u"\u0028\u110F\u1161\u0029",
       u"\u3219": u"\u0028\u1110\u1161\u0029",
       u"\u321A": u"\u0028\u1111\u1161\u0029",
       u"\u321B": u"\u0028\u1112\u1161\u0029",
       u"\u321C": u"\u0028\u110C\u116E\u0029",
       u"\u321D": u"\u0028\u110B\u1169\u110C\u1165\u11AB\u0029",
       u"\u321E": u"\u0028\u110B\u1169\u1112\u116E\u0029",
       u"\u3220": u"\u0028\u4E00\u0029",
       u"\u3221": u"\u0028\u4E8C\u0029",
       u"\u3222": u"\u0028\u4E09\u0029",
       u"\u3223": u"\u0028\u56DB\u0029",
       u"\u3224": u"\u0028\u4E94\u0029",
       u"\u3225": u"\u0028\u516D\u0029",
       u"\u3226": u"\u0028\u4E03\u0029",
       u"\u3227": u"\u0028\u516B\u0029",
       u"\u3228": u"\u0028\u4E5D\u0029",
       u"\u3229": u"\u0028\u5341\u0029",
       u"\u322A": u"\u0028\u6708\u0029",
       u"\u322B": u"\u0028\u706B\u0029",
       u"\u322C": u"\u0028\u6C34\u0029",
       u"\u322D": u"\u0028\u6728\u0029",
       u"\u322E": u"\u0028\u91D1\u0029",
       u"\u322F": u"\u0028\u571F\u0029",
       u"\u3230": u"\u0028\u65E5\u0029",
       u"\u3231": u"\u0028\u682A\u0029",
       u"\u3232": u"\u0028\u6709\u0029",
       u"\u3233": u"\u0028\u793E\u0029",
       u"\u3234": u"\u0028\u540D\u0029",
       u"\u3235": u"\u0028\u7279\u0029",
       u"\u3236": u"\u0028\u8CA1\u0029",
       u"\u3237": u"\u0028\u795D\u0029",
       u"\u3238": u"\u0028\u52B4\u0029",
       u"\u3239": u"\u0028\u4EE3\u0029",
       u"\u323A": u"\u0028\u547C\u0029",
       u"\u323B": u"\u0028\u5B66\u0029",
       u"\u323C": u"\u0028\u76E3\u0029",
       u"\u323D": u"\u0028\u4F01\u0029",
       u"\u323E": u"\u0028\u8CC7\u0029",
       u"\u323F": u"\u0028\u5354\u0029",
       u"\u3240": u"\u0028\u796D\u0029",
       u"\u3241": u"\u0028\u4F11\u0029",
       u"\u3242": u"\u0028\u81EA\u0029",
       u"\u3243": u"\u0028\u81F3\u0029",
       u"\u32C0": u"\u0031\u6708",
       u"\u32C1": u"\u0032\u6708",
       u"\u32C2": u"\u0033\u6708",
       u"\u32C3": u"\u0034\u6708",
       u"\u32C4": u"\u0035\u6708",
       u"\u32C5": u"\u0036\u6708",
       u"\u32C6": u"\u0037\u6708",
       u"\u32C7": u"\u0038\u6708",
       u"\u32C8": u"\u0039\u6708",
       u"\u32C9": u"\u0031\u0030\u6708",
       u"\u32CA": u"\u0031\u0031\u6708",
       u"\u32CB": u"\u0031\u0032\u6708",
       u"\u3358": u"\u0030\u70B9",
       u"\u3359": u"\u0031\u70B9",
       u"\u335A": u"\u0032\u70B9",
       u"\u335B": u"\u0033\u70B9",
       u"\u335C": u"\u0034\u70B9",
       u"\u335D": u"\u0035\u70B9",
       u"\u335E": u"\u0036\u70B9",
       u"\u335F": u"\u0037\u70B9",
       u"\u3360": u"\u0038\u70B9",
       u"\u3361": u"\u0039\u70B9",
       u"\u3362": u"\u0031\u0030\u70B9",
       u"\u3363": u"\u0031\u0031\u70B9",
       u"\u3364": u"\u0031\u0032\u70B9",
       u"\u3365": u"\u0031\u0033\u70B9",
       u"\u3366": u"\u0031\u0034\u70B9",
       u"\u3367": u"\u0031\u0035\u70B9",
       u"\u3368": u"\u0031\u0036\u70B9",
       u"\u3369": u"\u0031\u0037\u70B9",
       u"\u336A": u"\u0031\u0038\u70B9",
       u"\u336B": u"\u0031\u0039\u70B9",
       u"\u336C": u"\u0032\u0030\u70B9",
       u"\u336D": u"\u0032\u0031\u70B9",
       u"\u336E": u"\u0032\u0032\u70B9",
       u"\u336F": u"\u0032\u0033\u70B9",
       u"\u3370": u"\u0032\u0034\u70B9",
       u"\u33E0": u"\u0031\u65E5",
       u"\u33E1": u"\u0032\u65E5",
       u"\u33E2": u"\u0033\u65E5",
       u"\u33E3": u"\u0034\u65E5",
       u"\u33E4": u"\u0035\u65E5",
       u"\u33E5": u"\u0036\u65E5",
       u"\u33E6": u"\u0037\u65E5",
       u"\u33E7": u"\u0038\u65E5",
       u"\u33E8": u"\u0039\u65E5",
       u"\u33E9": u"\u0031\u0030\u65E5",
       u"\u33EA": u"\u0031\u0031\u65E5",
       u"\u33EB": u"\u0031\u0032\u65E5",
       u"\u33EC": u"\u0031\u0033\u65E5",
       u"\u33ED": u"\u0031\u0034\u65E5",
       u"\u33EE": u"\u0031\u0035\u65E5",
       u"\u33EF": u"\u0031\u0036\u65E5",
       u"\u33F0": u"\u0031\u0037\u65E5",
       u"\u33F1": u"\u0031\u0038\u65E5",
       u"\u33F2": u"\u0031\u0039\u65E5",
       u"\u33F3": u"\u0032\u0030\u65E5",
       u"\u33F4": u"\u0032\u0031\u65E5",
       u"\u33F5": u"\u0032\u0032\u65E5",
       u"\u33F6": u"\u0032\u0033\u65E5",
       u"\u33F7": u"\u0032\u0034\u65E5",
       u"\u33F8": u"\u0032\u0035\u65E5",
       u"\u33F9": u"\u0032\u0036\u65E5",
       u"\u33FA": u"\u0032\u0037\u65E5",
       u"\u33FB": u"\u0032\u0038\u65E5",
       u"\u33FC": u"\u0032\u0039\u65E5",
       u"\u33FD": u"\u0033\u0030\u65E5",
       u"\u33FE": u"\u0033\u0031\u65E5",
       u"\uFB00": u"\u0066\u0066",
       u"\uFB01": u"\u0066\u0069",
       u"\uFB02": u"\u0066\u006C",
       u"\uFB03": u"\u0066\u0066\u0069",
       u"\uFB04": u"\u0066\u0066\u006C",
       u"\uFB05": u"\u017F\u0074",
       u"\uFB06": u"\u0073\u0074",
       u"\uFB13": u"\u0574\u0576",
       u"\uFB14": u"\u0574\u0565",
       u"\uFB15": u"\u0574\u056B",
       u"\uFB16": u"\u057E\u0576",
       u"\uFB17": u"\u0574\u056D",
       u"\uFB4F": u"\u05D0\u05DC",
       u"\uFB50": u"\u0671",
       u"\uFB51": u"\u0671",
       u"\uFB52": u"\u067B",
       u"\uFB53": u"\u067B",
       u"\uFB54": u"\u067B",
       u"\uFB55": u"\u067B",
       u"\uFB56": u"\u067E",
       u"\uFB57": u"\u067E",
       u"\uFB58": u"\u067E",
       u"\uFB59": u"\u067E",
       u"\uFB5A": u"\u0680",
       u"\uFB5B": u"\u0680",
       u"\uFB5C": u"\u0680",
       u"\uFB5D": u"\u0680",
       u"\uFB5E": u"\u067A",
       u"\uFB5F": u"\u067A",
       u"\uFB60": u"\u067A",
       u"\uFB61": u"\u067A",
       u"\uFB62": u"\u067F",
       u"\uFB63": u"\u067F",
       u"\uFB64": u"\u067F",
       u"\uFB65": u"\u067F",
       u"\uFB66": u"\u0679",
       u"\uFB67": u"\u0679",
       u"\uFB68": u"\u0679",
       u"\uFB69": u"\u0679",
       u"\uFB6A": u"\u06A4",
       u"\uFB6B": u"\u06A4",
       u"\uFB6C": u"\u06A4",
       u"\uFB6D": u"\u06A4",
       u"\uFB6E": u"\u06A6",
       u"\uFB6F": u"\u06A6",
       u"\uFB70": u"\u06A6",
       u"\uFB71": u"\u06A6",
       u"\uFB72": u"\u0684",
       u"\uFB73": u"\u0684",
       u"\uFB74": u"\u0684",
       u"\uFB75": u"\u0684",
       u"\uFB76": u"\u0683",
       u"\uFB77": u"\u0683",
       u"\uFB78": u"\u0683",
       u"\uFB79": u"\u0683",
       u"\uFB7A": u"\u0686",
       u"\uFB7B": u"\u0686",
       u"\uFB7C": u"\u0686",
       u"\uFB7D": u"\u0686",
       u"\uFB7E": u"\u0687",
       u"\uFB7F": u"\u0687",
       u"\uFB80": u"\u0687",
       u"\uFB81": u"\u0687",
       u"\uFB82": u"\u068D",
       u"\uFB83": u"\u068D",
       u"\uFB84": u"\u068C",
       u"\uFB85": u"\u068C",
       u"\uFB86": u"\u068E",
       u"\uFB87": u"\u068E",
       u"\uFB88": u"\u0688",
       u"\uFB89": u"\u0688",
       u"\uFB8A": u"\u0698",
       u"\uFB8B": u"\u0698",
       u"\uFB8C": u"\u0691",
       u"\uFB8D": u"\u0691",
       u"\uFB8E": u"\u06A9",
       u"\uFB8F": u"\u06A9",
       u"\uFB90": u"\u06A9",
       u"\uFB91": u"\u06A9",
       u"\uFB92": u"\u06AF",
       u"\uFB93": u"\u06AF",
       u"\uFB94": u"\u06AF",
       u"\uFB95": u"\u06AF",
       u"\uFB96": u"\u06B3",
       u"\uFB97": u"\u06B3",
       u"\uFB98": u"\u06B3",
       u"\uFB99": u"\u06B3",
       u"\uFB9A": u"\u06B1",
       u"\uFB9B": u"\u06B1",
       u"\uFB9C": u"\u06B1",
       u"\uFB9D": u"\u06B1",
       u"\uFB9E": u"\u06BA",
       u"\uFB9F": u"\u06BA",
       u"\uFBA0": u"\u06BB",
       u"\uFBA1": u"\u06BB",
       u"\uFBA2": u"\u06BB",
       u"\uFBA3": u"\u06BB",
       u"\uFBA4": u"\u06C0",
       u"\uFBA5": u"\u06C0",
       u"\uFBA6": u"\u06C1",
       u"\uFBA7": u"\u06C1",
       u"\uFBA8": u"\u06C1",
       u"\uFBA9": u"\u06C1",
       u"\uFBAA": u"\u06BE",
       u"\uFBAB": u"\u06BE",
       u"\uFBAC": u"\u06BE",
       u"\uFBAD": u"\u06BE",
       u"\uFBAE": u"\u06D2",
       u"\uFBAF": u"\u06D2",
       u"\uFBB0": u"\u06D3",
       u"\uFBB1": u"\u06D3",
       u"\uFBD3": u"\u06AD",
       u"\uFBD4": u"\u06AD",
       u"\uFBD5": u"\u06AD",
       u"\uFBD6": u"\u06AD",
       u"\uFBD7": u"\u06C7",
       u"\uFBD8": u"\u06C7",
       u"\uFBD9": u"\u06C6",
       u"\uFBDA": u"\u06C6",
       u"\uFBDB": u"\u06C8",
       u"\uFBDC": u"\u06C8",
       u"\uFBDD": u"\u0677",
       u"\uFBDE": u"\u06CB",
       u"\uFBDF": u"\u06CB",
       u"\uFBE0": u"\u06C5",
       u"\uFBE1": u"\u06C5",
       u"\uFBE2": u"\u06C9",
       u"\uFBE3": u"\u06C9",
       u"\uFBE4": u"\u06D0",
       u"\uFBE5": u"\u06D0",
       u"\uFBE6": u"\u06D0",
       u"\uFBE7": u"\u06D0",
       u"\uFBE8": u"\u0649",
       u"\uFBE9": u"\u0649",
       u"\uFBEA": u"\u0626\u0627",
       u"\uFBEB": u"\u0626\u0627",
       u"\uFBEC": u"\u0626\u06D5",
       u"\uFBED": u"\u0626\u06D5",
       u"\uFBEE": u"\u0626\u0648",
       u"\uFBEF": u"\u0626\u0648",
       u"\uFBF0": u"\u0626\u06C7",
       u"\uFBF1": u"\u0626\u06C7",
       u"\uFBF2": u"\u0626\u06C6",
       u"\uFBF3": u"\u0626\u06C6",
       u"\uFBF4": u"\u0626\u06C8",
       u"\uFBF5": u"\u0626\u06C8",
       u"\uFBF6": u"\u0626\u06D0",
       u"\uFBF7": u"\u0626\u06D0",
       u"\uFBF8": u"\u0626\u06D0",
       u"\uFBF9": u"\u0626\u0649",
       u"\uFBFA": u"\u0626\u0649",
       u"\uFBFB": u"\u0626\u0649",
       u"\uFBFC": u"\u06CC",
       u"\uFBFD": u"\u06CC",
       u"\uFBFE": u"\u06CC",
       u"\uFBFF": u"\u06CC",
       u"\uFC00": u"\u0626\u062C",
       u"\uFC01": u"\u0626\u062D",
       u"\uFC02": u"\u0626\u0645",
       u"\uFC03": u"\u0626\u0649",
       u"\uFC04": u"\u0626\u064A",
       u"\uFC05": u"\u0628\u062C",
       u"\uFC06": u"\u0628\u062D",
       u"\uFC07": u"\u0628\u062E",
       u"\uFC08": u"\u0628\u0645",
       u"\uFC09": u"\u0628\u0649",
       u"\uFC0A": u"\u0628\u064A",
       u"\uFC0B": u"\u062A\u062C",
       u"\uFC0C": u"\u062A\u062D",
       u"\uFC0D": u"\u062A\u062E",
       u"\uFC0E": u"\u062A\u0645",
       u"\uFC0F": u"\u062A\u0649",
       u"\uFC10": u"\u062A\u064A",
       u"\uFC11": u"\u062B\u062C",
       u"\uFC12": u"\u062B\u0645",
       u"\uFC13": u"\u062B\u0649",
       u"\uFC14": u"\u062B\u064A",
       u"\uFC15": u"\u062C\u062D",
       u"\uFC16": u"\u062C\u0645",
       u"\uFC17": u"\u062D\u062C",
       u"\uFC18": u"\u062D\u0645",
       u"\uFC19": u"\u062E\u062C",
       u"\uFC1A": u"\u062E\u062D",
       u"\uFC1B": u"\u062E\u0645",
       u"\uFC1C": u"\u0633\u062C",
       u"\uFC1D": u"\u0633\u062D",
       u"\uFC1E": u"\u0633\u062E",
       u"\uFC1F": u"\u0633\u0645",
       u"\uFC20": u"\u0635\u062D",
       u"\uFC21": u"\u0635\u0645",
       u"\uFC22": u"\u0636\u062C",
       u"\uFC23": u"\u0636\u062D",
       u"\uFC24": u"\u0636\u062E",
       u"\uFC25": u"\u0636\u0645",
       u"\uFC26": u"\u0637\u062D",
       u"\uFC27": u"\u0637\u0645",
       u"\uFC28": u"\u0638\u0645",
       u"\uFC29": u"\u0639\u062C",
       u"\uFC2A": u"\u0639\u0645",
       u"\uFC2B": u"\u063A\u062C",
       u"\uFC2C": u"\u063A\u0645",
       u"\uFC2D": u"\u0641\u062C",
       u"\uFC2E": u"\u0641\u062D",
       u"\uFC2F": u"\u0641\u062E",
       u"\uFC30": u"\u0641\u0645",
       u"\uFC31": u"\u0641\u0649",
       u"\uFC32": u"\u0641\u064A",
       u"\uFC33": u"\u0642\u062D",
       u"\uFC34": u"\u0642\u0645",
       u"\uFC35": u"\u0642\u0649",
       u"\uFC36": u"\u0642\u064A",
       u"\uFC37": u"\u0643\u0627",
       u"\uFC38": u"\u0643\u062C",
       u"\uFC39": u"\u0643\u062D",
       u"\uFC3A": u"\u0643\u062E",
       u"\uFC3B": u"\u0643\u0644",
       u"\uFC3C": u"\u0643\u0645",
       u"\uFC3D": u"\u0643\u0649",
       u"\uFC3E": u"\u0643\u064A",
       u"\uFC3F": u"\u0644\u062C",
       u"\uFC40": u"\u0644\u062D",
       u"\uFC41": u"\u0644\u062E",
       u"\uFC42": u"\u0644\u0645",
       u"\uFC43": u"\u0644\u0649",
       u"\uFC44": u"\u0644\u064A",
       u"\uFC45": u"\u0645\u062C",
       u"\uFC46": u"\u0645\u062D",
       u"\uFC47": u"\u0645\u062E",
       u"\uFC48": u"\u0645\u0645",
       u"\uFC49": u"\u0645\u0649",
       u"\uFC4A": u"\u0645\u064A",
       u"\uFC4B": u"\u0646\u062C",
       u"\uFC4C": u"\u0646\u062D",
       u"\uFC4D": u"\u0646\u062E",
       u"\uFC4E": u"\u0646\u0645",
       u"\uFC4F": u"\u0646\u0649",
       u"\uFC50": u"\u0646\u064A",
       u"\uFC51": u"\u0647\u062C",
       u"\uFC52": u"\u0647\u0645",
       u"\uFC53": u"\u0647\u0649",
       u"\uFC54": u"\u0647\u064A",
       u"\uFC55": u"\u064A\u062C",
       u"\uFC56": u"\u064A\u062D",
       u"\uFC57": u"\u064A\u062E",
       u"\uFC58": u"\u064A\u0645",
       u"\uFC59": u"\u064A\u0649",
       u"\uFC5A": u"\u064A\u064A",
       u"\uFC5B": u"\u0630\u0670",
       u"\uFC5C": u"\u0631\u0670",
       u"\uFC5D": u"\u0649\u0670",
       u"\uFC5E": u"\u0020\u064C\u0651",
       u"\uFC5F": u"\u0020\u064D\u0651",
       u"\uFC60": u"\u0020\u064E\u0651",
       u"\uFC61": u"\u0020\u064F\u0651",
       u"\uFC62": u"\u0020\u0650\u0651",
       u"\uFC63": u"\u0020\u0651\u0670",
       u"\uFC64": u"\u0626\u0631",
       u"\uFC65": u"\u0626\u0632",
       u"\uFC66": u"\u0626\u0645",
       u"\uFC67": u"\u0626\u0646",
       u"\uFC68": u"\u0626\u0649",
       u"\uFC69": u"\u0626\u064A",
       u"\uFC6A": u"\u0628\u0631",
       u"\uFC6B": u"\u0628\u0632",
       u"\uFC6C": u"\u0628\u0645",
       u"\uFC6D": u"\u0628\u0646",
       u"\uFC6E": u"\u0628\u0649",
       u"\uFC6F": u"\u0628\u064A",
       u"\uFC70": u"\u062A\u0631",
       u"\uFC71": u"\u062A\u0632",
       u"\uFC72": u"\u062A\u0645",
       u"\uFC73": u"\u062A\u0646",
       u"\uFC74": u"\u062A\u0649",
       u"\uFC75": u"\u062A\u064A",
       u"\uFC76": u"\u062B\u0631",
       u"\uFC77": u"\u062B\u0632",
       u"\uFC78": u"\u062B\u0645",
       u"\uFC79": u"\u062B\u0646",
       u"\uFC7A": u"\u062B\u0649",
       u"\uFC7B": u"\u062B\u064A",
       u"\uFC7C": u"\u0641\u0649",
       u"\uFC7D": u"\u0641\u064A",
       u"\uFC7E": u"\u0642\u0649",
       u"\uFC7F": u"\u0642\u064A",
       u"\uFC80": u"\u0643\u0627",
       u"\uFC81": u"\u0643\u0644",
       u"\uFC82": u"\u0643\u0645",
       u"\uFC83": u"\u0643\u0649",
       u"\uFC84": u"\u0643\u064A",
       u"\uFC85": u"\u0644\u0645",
       u"\uFC86": u"\u0644\u0649",
       u"\uFC87": u"\u0644\u064A",
       u"\uFC88": u"\u0645\u0627",
       u"\uFC89": u"\u0645\u0645",
       u"\uFC8A": u"\u0646\u0631",
       u"\uFC8B": u"\u0646\u0632",
       u"\uFC8C": u"\u0646\u0645",
       u"\uFC8D": u"\u0646\u0646",
       u"\uFC8E": u"\u0646\u0649",
       u"\uFC8F": u"\u0646\u064A",
       u"\uFC90": u"\u0649\u0670",
       u"\uFC91": u"\u064A\u0631",
       u"\uFC92": u"\u064A\u0632",
       u"\uFC93": u"\u064A\u0645",
       u"\uFC94": u"\u064A\u0646",
       u"\uFC95": u"\u064A\u0649",
       u"\uFC96": u"\u064A\u064A",
       u"\uFC97": u"\u0626\u062C",
       u"\uFC98": u"\u0626\u062D",
       u"\uFC99": u"\u0626\u062E",
       u"\uFC9A": u"\u0626\u0645",
       u"\uFC9B": u"\u0626\u0647",
       u"\uFC9C": u"\u0628\u062C",
       u"\uFC9D": u"\u0628\u062D",
       u"\uFC9E": u"\u0628\u062E",
       u"\uFC9F": u"\u0628\u0645",
       u"\uFCA0": u"\u0628\u0647",
       u"\uFCA1": u"\u062A\u062C",
       u"\uFCA2": u"\u062A\u062D",
       u"\uFCA3": u"\u062A\u062E",
       u"\uFCA4": u"\u062A\u0645",
       u"\uFCA5": u"\u062A\u0647",
       u"\uFCA6": u"\u062B\u0645",
       u"\uFCA7": u"\u062C\u062D",
       u"\uFCA8": u"\u062C\u0645",
       u"\uFCA9": u"\u062D\u062C",
       u"\uFCAA": u"\u062D\u0645",
       u"\uFCAB": u"\u062E\u062C",
       u"\uFCAC": u"\u062E\u0645",
       u"\uFCAD": u"\u0633\u062C",
       u"\uFCAE": u"\u0633\u062D",
       u"\uFCAF": u"\u0633\u062E",
       u"\uFCB0": u"\u0633\u0645",
       u"\uFCB1": u"\u0635\u062D",
       u"\uFCB2": u"\u0635\u062E",
       u"\uFCB3": u"\u0635\u0645",
       u"\uFCB4": u"\u0636\u062C",
       u"\uFCB5": u"\u0636\u062D",
       u"\uFCB6": u"\u0636\u062E",
       u"\uFCB7": u"\u0636\u0645",
       u"\uFCB8": u"\u0637\u062D",
       u"\uFCB9": u"\u0638\u0645",
       u"\uFCBA": u"\u0639\u062C",
       u"\uFCBB": u"\u0639\u0645",
       u"\uFCBC": u"\u063A\u062C",
       u"\uFCBD": u"\u063A\u0645",
       u"\uFCBE": u"\u0641\u062C",
       u"\uFCBF": u"\u0641\u062D",
       u"\uFCC0": u"\u0641\u062E",
       u"\uFCC1": u"\u0641\u0645",
       u"\uFCC2": u"\u0642\u062D",
       u"\uFCC3": u"\u0642\u0645",
       u"\uFCC4": u"\u0643\u062C",
       u"\uFCC5": u"\u0643\u062D",
       u"\uFCC6": u"\u0643\u062E",
       u"\uFCC7": u"\u0643\u0644",
       u"\uFCC8": u"\u0643\u0645",
       u"\uFCC9": u"\u0644\u062C",
       u"\uFCCA": u"\u0644\u062D",
       u"\uFCCB": u"\u0644\u062E",
       u"\uFCCC": u"\u0644\u0645",
       u"\uFCCD": u"\u0644\u0647",
       u"\uFCCE": u"\u0645\u062C",
       u"\uFCCF": u"\u0645\u062D",
       u"\uFCD0": u"\u0645\u062E",
       u"\uFCD1": u"\u0645\u0645",
       u"\uFCD2": u"\u0646\u062C",
       u"\uFCD3": u"\u0646\u062D",
       u"\uFCD4": u"\u0646\u062E",
       u"\uFCD5": u"\u0646\u0645",
       u"\uFCD6": u"\u0646\u0647",
       u"\uFCD7": u"\u0647\u062C",
       u"\uFCD8": u"\u0647\u0645",
       u"\uFCD9": u"\u0647\u0670",
       u"\uFCDA": u"\u064A\u062C",
       u"\uFCDB": u"\u064A\u062D",
       u"\uFCDC": u"\u064A\u062E",
       u"\uFCDD": u"\u064A\u0645",
       u"\uFCDE": u"\u064A\u0647",
       u"\uFCDF": u"\u0626\u0645",
       u"\uFCE0": u"\u0626\u0647",
       u"\uFCE1": u"\u0628\u0645",
       u"\uFCE2": u"\u0628\u0647",
       u"\uFCE3": u"\u062A\u0645",
       u"\uFCE4": u"\u062A\u0647",
       u"\uFCE5": u"\u062B\u0645",
       u"\uFCE6": u"\u062B\u0647",
       u"\uFCE7": u"\u0633\u0645",
       u"\uFCE8": u"\u0633\u0647",
       u"\uFCE9": u"\u0634\u0645",
       u"\uFCEA": u"\u0634\u0647",
       u"\uFCEB": u"\u0643\u0644",
       u"\uFCEC": u"\u0643\u0645",
       u"\uFCED": u"\u0644\u0645",
       u"\uFCEE": u"\u0646\u0645",
       u"\uFCEF": u"\u0646\u0647",
       u"\uFCF0": u"\u064A\u0645",
       u"\uFCF1": u"\u064A\u0647",
       u"\uFCF2": u"\u0640\u064E\u0651",
       u"\uFCF3": u"\u0640\u064F\u0651",
       u"\uFCF4": u"\u0640\u0650\u0651",
       u"\uFCF5": u"\u0637\u0649",
       u"\uFCF6": u"\u0637\u064A",
       u"\uFCF7": u"\u0639\u0649",
       u"\uFCF8": u"\u0639\u064A",
       u"\uFCF9": u"\u063A\u0649",
       u"\uFCFA": u"\u063A\u064A",
       u"\uFCFB": u"\u0633\u0649",
       u"\uFCFC": u"\u0633\u064A",
       u"\uFCFD": u"\u0634\u0649",
       u"\uFCFE": u"\u0634\u064A",
       u"\uFCFF": u"\u062D\u0649",
       u"\uFD00": u"\u062D\u064A",
       u"\uFD01": u"\u062C\u0649",
       u"\uFD02": u"\u062C\u064A",
       u"\uFD03": u"\u062E\u0649",
       u"\uFD04": u"\u062E\u064A",
       u"\uFD05": u"\u0635\u0649",
       u"\uFD06": u"\u0635\u064A",
       u"\uFD07": u"\u0636\u0649",
       u"\uFD08": u"\u0636\u064A",
       u"\uFD09": u"\u0634\u062C",
       u"\uFD0A": u"\u0634\u062D",
       u"\uFD0B": u"\u0634\u062E",
       u"\uFD0C": u"\u0634\u0645",
       u"\uFD0D": u"\u0634\u0631",
       u"\uFD0E": u"\u0633\u0631",
       u"\uFD0F": u"\u0635\u0631",
       u"\uFD10": u"\u0636\u0631",
       u"\uFD11": u"\u0637\u0649",
       u"\uFD12": u"\u0637\u064A",
       u"\uFD13": u"\u0639\u0649",
       u"\uFD14": u"\u0639\u064A",
       u"\uFD15": u"\u063A\u0649",
       u"\uFD16": u"\u063A\u064A",
       u"\uFD17": u"\u0633\u0649",
       u"\uFD18": u"\u0633\u064A",
       u"\uFD19": u"\u0634\u0649",
       u"\uFD1A": u"\u0634\u064A",
       u"\uFD1B": u"\u062D\u0649",
       u"\uFD1C": u"\u062D\u064A",
       u"\uFD1D": u"\u062C\u0649",
       u"\uFD1E": u"\u062C\u064A",
       u"\uFD1F": u"\u062E\u0649",
       u"\uFD20": u"\u062E\u064A",
       u"\uFD21": u"\u0635\u0649",
       u"\uFD22": u"\u0635\u064A",
       u"\uFD23": u"\u0636\u0649",
       u"\uFD24": u"\u0636\u064A",
       u"\uFD25": u"\u0634\u062C",
       u"\uFD26": u"\u0634\u062D",
       u"\uFD27": u"\u0634\u062E",
       u"\uFD28": u"\u0634\u0645",
       u"\uFD29": u"\u0634\u0631",
       u"\uFD2A": u"\u0633\u0631",
       u"\uFD2B": u"\u0635\u0631",
       u"\uFD2C": u"\u0636\u0631",
       u"\uFD2D": u"\u0634\u062C",
       u"\uFD2E": u"\u0634\u062D",
       u"\uFD2F": u"\u0634\u062E",
       u"\uFD30": u"\u0634\u0645",
       u"\uFD31": u"\u0633\u0647",
       u"\uFD32": u"\u0634\u0647",
       u"\uFD33": u"\u0637\u0645",
       u"\uFD34": u"\u0633\u062C",
       u"\uFD35": u"\u0633\u062D",
       u"\uFD36": u"\u0633\u062E",
       u"\uFD37": u"\u0634\u062C",
       u"\uFD38": u"\u0634\u062D",
       u"\uFD39": u"\u0634\u062E",
       u"\uFD3A": u"\u0637\u0645",
       u"\uFD3B": u"\u0638\u0645",
       u"\uFD3C": u"\u0627\u064B",
       u"\uFD3D": u"\u0627\u064B",
       u"\uFD50": u"\u062A\u062C\u0645",
       u"\uFD51": u"\u062A\u062D\u062C",
       u"\uFD52": u"\u062A\u062D\u062C",
       u"\uFD53": u"\u062A\u062D\u0645",
       u"\uFD54": u"\u062A\u062E\u0645",
       u"\uFD55": u"\u062A\u0645\u062C",
       u"\uFD56": u"\u062A\u0645\u062D",
       u"\uFD57": u"\u062A\u0645\u062E",
       u"\uFD58": u"\u062C\u0645\u062D",
       u"\uFD59": u"\u062C\u0645\u062D",
       u"\uFD5A": u"\u062D\u0645\u064A",
       u"\uFD5B": u"\u062D\u0645\u0649",
       u"\uFD5C": u"\u0633\u062D\u062C",
       u"\uFD5D": u"\u0633\u062C\u062D",
       u"\uFD5E": u"\u0633\u062C\u0649",
       u"\uFD5F": u"\u0633\u0645\u062D",
       u"\uFD60": u"\u0633\u0645\u062D",
       u"\uFD61": u"\u0633\u0645\u062C",
       u"\uFD62": u"\u0633\u0645\u0645",
       u"\uFD63": u"\u0633\u0645\u0645",
       u"\uFD64": u"\u0635\u062D\u062D",
       u"\uFD65": u"\u0635\u062D\u062D",
       u"\uFD66": u"\u0635\u0645\u0645",
       u"\uFD67": u"\u0634\u062D\u0645",
       u"\uFD68": u"\u0634\u062D\u0645",
       u"\uFD69": u"\u0634\u062C\u064A",
       u"\uFD6A": u"\u0634\u0645\u062E",
       u"\uFD6B": u"\u0634\u0645\u062E",
       u"\uFD6C": u"\u0634\u0645\u0645",
       u"\uFD6D": u"\u0634\u0645\u0645",
       u"\uFD6E": u"\u0636\u062D\u0649",
       u"\uFD6F": u"\u0636\u062E\u0645",
       u"\uFD70": u"\u0636\u062E\u0645",
       u"\uFD71": u"\u0637\u0645\u062D",
       u"\uFD72": u"\u0637\u0645\u062D",
       u"\uFD73": u"\u0637\u0645\u0645",
       u"\uFD74": u"\u0637\u0645\u064A",
       u"\uFD75": u"\u0639\u062C\u0645",
       u"\uFD76": u"\u0639\u0645\u0645",
       u"\uFD77": u"\u0639\u0645\u0645",
       u"\uFD78": u"\u0639\u0645\u0649",
       u"\uFD79": u"\u063A\u0645\u0645",
       u"\uFD7A": u"\u063A\u0645\u064A",
       u"\uFD7B": u"\u063A\u0645\u0649",
       u"\uFD7C": u"\u0641\u062E\u0645",
       u"\uFD7D": u"\u0641\u062E\u0645",
       u"\uFD7E": u"\u0642\u0645\u062D",
       u"\uFD7F": u"\u0642\u0645\u0645",
       u"\uFD80": u"\u0644\u062D\u0645",
       u"\uFD81": u"\u0644\u062D\u064A",
       u"\uFD82": u"\u0644\u062D\u0649",
       u"\uFD83": u"\u0644\u062C\u062C",
       u"\uFD84": u"\u0644\u062C\u062C",
       u"\uFD85": u"\u0644\u062E\u0645",
       u"\uFD86": u"\u0644\u062E\u0645",
       u"\uFD87": u"\u0644\u0645\u062D",
       u"\uFD88": u"\u0644\u0645\u062D",
       u"\uFD89": u"\u0645\u062D\u062C",
       u"\uFD8A": u"\u0645\u062D\u0645",
       u"\uFD8B": u"\u0645\u062D\u064A",
       u"\uFD8C": u"\u0645\u062C\u062D",
       u"\uFD8D": u"\u0645\u062C\u0645",
       u"\uFD8E": u"\u0645\u062E\u062C",
       u"\uFD8F": u"\u0645\u062E\u0645",
       u"\uFD92": u"\u0645\u062C\u062E",
       u"\uFD93": u"\u0647\u0645\u062C",
       u"\uFD94": u"\u0647\u0645\u0645",
       u"\uFD95": u"\u0646\u062D\u0645",
       u"\uFD96": u"\u0646\u062D\u0649",
       u"\uFD97": u"\u0646\u062C\u0645",
       u"\uFD98": u"\u0646\u062C\u0645",
       u"\uFD99": u"\u0646\u062C\u0649",
       u"\uFD9A": u"\u0646\u0645\u064A",
       u"\uFD9B": u"\u0646\u0645\u0649",
       u"\uFD9C": u"\u064A\u0645\u0645",
       u"\uFD9D": u"\u064A\u0645\u0645",
       u"\uFD9E": u"\u0628\u062E\u064A",
       u"\uFD9F": u"\u062A\u062C\u064A",
       u"\uFDA0": u"\u062A\u062C\u0649",
       u"\uFDA1": u"\u062A\u062E\u064A",
       u"\uFDA2": u"\u062A\u062E\u0649",
       u"\uFDA3": u"\u062A\u0645\u064A",
       u"\uFDA4": u"\u062A\u0645\u0649",
       u"\uFDA5": u"\u062C\u0645\u064A",
       u"\uFDA6": u"\u062C\u062D\u0649",
       u"\uFDA7": u"\u062C\u0645\u0649",
       u"\uFDA8": u"\u0633\u062E\u0649",
       u"\uFDA9": u"\u0635\u062D\u064A",
       u"\uFDAA": u"\u0634\u062D\u064A",
       u"\uFDAB": u"\u0636\u062D\u064A",
       u"\uFDAC": u"\u0644\u062C\u064A",
       u"\uFDAD": u"\u0644\u0645\u064A",
       u"\uFDAE": u"\u064A\u062D\u064A",
       u"\uFDAF": u"\u064A\u062C\u064A",
       u"\uFDB0": u"\u064A\u0645\u064A",
       u"\uFDB1": u"\u0645\u0645\u064A",
       u"\uFDB2": u"\u0642\u0645\u064A",
       u"\uFDB3": u"\u0646\u062D\u064A",
       u"\uFDB4": u"\u0642\u0645\u062D",
       u"\uFDB5": u"\u0644\u062D\u0645",
       u"\uFDB6": u"\u0639\u0645\u064A",
       u"\uFDB7": u"\u0643\u0645\u064A",
       u"\uFDB8": u"\u0646\u062C\u062D",
       u"\uFDB9": u"\u0645\u062E\u064A",
       u"\uFDBA": u"\u0644\u062C\u0645",
       u"\uFDBB": u"\u0643\u0645\u0645",
       u"\uFDBC": u"\u0644\u062C\u0645",
       u"\uFDBD": u"\u0646\u062C\u062D",
       u"\uFDBE": u"\u062C\u062D\u064A",
       u"\uFDBF": u"\u062D\u062C\u064A",
       u"\uFDC0": u"\u0645\u062C\u064A",
       u"\uFDC1": u"\u0641\u0645\u064A",
       u"\uFDC2": u"\u0628\u062D\u064A",
       u"\uFDC3": u"\u0643\u0645\u0645",
       u"\uFDC4": u"\u0639\u062C\u0645",
       u"\uFDC5": u"\u0635\u0645\u0645",
       u"\uFDC6": u"\u0633\u062E\u064A",
       u"\uFDC7": u"\u0646\u062C\u064A",
       u"\uFE49": u"\u203E",
       u"\uFE4A": u"\u203E",
       u"\uFE4B": u"\u203E",
       u"\uFE4C": u"\u203E",
       u"\uFE4D": u"\u005F",
       u"\uFE4E": u"\u005F",
       u"\uFE4F": u"\u005F",
       u"\uFE80": u"\u0621",
       u"\uFE81": u"\u0622",
       u"\uFE82": u"\u0622",
       u"\uFE83": u"\u0623",
       u"\uFE84": u"\u0623",
       u"\uFE85": u"\u0624",
       u"\uFE86": u"\u0624",
       u"\uFE87": u"\u0625",
       u"\uFE88": u"\u0625",
       u"\uFE89": u"\u0626",
       u"\uFE8A": u"\u0626",
       u"\uFE8B": u"\u0626",
       u"\uFE8C": u"\u0626",
       u"\uFE8D": u"\u0627",
       u"\uFE8E": u"\u0627",
       u"\uFE8F": u"\u0628",
       u"\uFE90": u"\u0628",
       u"\uFE91": u"\u0628",
       u"\uFE92": u"\u0628",
       u"\uFE93": u"\u0629",
       u"\uFE94": u"\u0629",
       u"\uFE95": u"\u062A",
       u"\uFE96": u"\u062A",
       u"\uFE97": u"\u062A",
       u"\uFE98": u"\u062A",
       u"\uFE99": u"\u062B",
       u"\uFE9A": u"\u062B",
       u"\uFE9B": u"\u062B",
       u"\uFE9C": u"\u062B",
       u"\uFE9D": u"\u062C",
       u"\uFE9E": u"\u062C",
       u"\uFE9F": u"\u062C",
       u"\uFEA0": u"\u062C",
       u"\uFEA1": u"\u062D",
       u"\uFEA2": u"\u062D",
       u"\uFEA3": u"\u062D",
       u"\uFEA4": u"\u062D",
       u"\uFEA5": u"\u062E",
       u"\uFEA6": u"\u062E",
       u"\uFEA7": u"\u062E",
       u"\uFEA8": u"\u062E",
       u"\uFEA9": u"\u062F",
       u"\uFEAA": u"\u062F",
       u"\uFEAB": u"\u0630",
       u"\uFEAC": u"\u0630",
       u"\uFEAD": u"\u0631",
       u"\uFEAE": u"\u0631",
       u"\uFEAF": u"\u0632",
       u"\uFEB0": u"\u0632",
       u"\uFEB1": u"\u0633",
       u"\uFEB2": u"\u0633",
       u"\uFEB3": u"\u0633",
       u"\uFEB4": u"\u0633",
       u"\uFEB5": u"\u0634",
       u"\uFEB6": u"\u0634",
       u"\uFEB7": u"\u0634",
       u"\uFEB8": u"\u0634",
       u"\uFEB9": u"\u0635",
       u"\uFEBA": u"\u0635",
       u"\uFEBB": u"\u0635",
       u"\uFEBC": u"\u0635",
       u"\uFEBD": u"\u0636",
       u"\uFEBE": u"\u0636",
       u"\uFEBF": u"\u0636",
       u"\uFEC0": u"\u0636",
       u"\uFEC1": u"\u0637",
       u"\uFEC2": u"\u0637",
       u"\uFEC3": u"\u0637",
       u"\uFEC4": u"\u0637",
       u"\uFEC5": u"\u0638",
       u"\uFEC6": u"\u0638",
       u"\uFEC7": u"\u0638",
       u"\uFEC8": u"\u0638",
       u"\uFEC9": u"\u0639",
       u"\uFECA": u"\u0639",
       u"\uFECB": u"\u0639",
       u"\uFECC": u"\u0639",
       u"\uFECD": u"\u063A",
       u"\uFECE": u"\u063A",
       u"\uFECF": u"\u063A",
       u"\uFED0": u"\u063A",
       u"\uFED1": u"\u0641",
       u"\uFED2": u"\u0641",
       u"\uFED3": u"\u0641",
       u"\uFED4": u"\u0641",
       u"\uFED5": u"\u0642",
       u"\uFED6": u"\u0642",
       u"\uFED7": u"\u0642",
       u"\uFED8": u"\u0642",
       u"\uFED9": u"\u0643",
       u"\uFEDA": u"\u0643",
       u"\uFEDB": u"\u0643",
       u"\uFEDC": u"\u0643",
       u"\uFEDD": u"\u0644",
       u"\uFEDE": u"\u0644",
       u"\uFEDF": u"\u0644",
       u"\uFEE0": u"\u0644",
       u"\uFEE1": u"\u0645",
       u"\uFEE2": u"\u0645",
       u"\uFEE3": u"\u0645",
       u"\uFEE4": u"\u0645",
       u"\uFEE5": u"\u0646",
       u"\uFEE6": u"\u0646",
       u"\uFEE7": u"\u0646",
       u"\uFEE8": u"\u0646",
       u"\uFEE9": u"\u0647",
       u"\uFEEA": u"\u0647",
       u"\uFEEB": u"\u0647",
       u"\uFEEC": u"\u0647",
       u"\uFEED": u"\u0648",
       u"\uFEEE": u"\u0648",
       u"\uFEEF": u"\u0649",
       u"\uFEF0": u"\u0649",
       u"\uFEF1": u"\u064A",
       u"\uFEF2": u"\u064A",
       u"\uFEF3": u"\u064A",
       u"\uFEF4": u"\u064A",
       u"\uFEF5": u"\u0644\u0622",
       u"\uFEF6": u"\u0644\u0622",
       u"\uFEF7": u"\u0644\u0623",
       u"\uFEF8": u"\u0644\u0623",
       u"\uFEF9": u"\u0644\u0625",
       u"\uFEFA": u"\u0644\u0625",
       u"\uFEFB": u"\u0644\u0627",
       u"\uFEFC": u"\u0644\u0627",
       u"\u2ee3": u"\u9aa8"}

  return replace_all(t, text)

def replace_all(repls, text):
  # return re.sub('|'.join(repls.keys()), lambda k: repls[k.group(0)], text)
  return re.sub(u'|'.join(re.escape(key) for key in repls.keys()),
                lambda k: repls[k.group(0)], text)

def normalizeUnicodes(text):
  text = normalizePunctuation(text)
  text = normalizeUnicode(text)
  text = "".join([Q2B(c) for c in list(text)])

  return text

def normalizePunctuation(text):
  cpun = [['	'],
          [u'﹗'],
          [u'“', u'゛'],
          [u'”'],
          [u'´', u'‘', u'’'],
          [u'；', u'﹔'],
          [u'《', u'〈', u'＜'],
          [u'》', u'〉', u'＞'],
          [u'﹑'],
          [u'【', u'『', u'〔'],
          [u'】', u'』', u'〕'],
          [u'（', u'「'],
          [u'）', u'」'],
          [u'﹖'],
          [u'︰', u'﹕'],
          [u'・', u'．', u'·', u'･', u'‧'],
          [u'●', u'○', u'▲', u'◎', u'◇', u'■', u'□', u'※', u'◆'],
          [u'〜', u'～'],
          [u'—', u'ー', u'―', u'‐', u'−', u'─', u'﹣', u'–']]
  epun = [u' ', u'！', u'"', u'"', u'\'', u';', u'<', u'>', u'、', u'[', u']', u'(', u')', u'？', u'：', u'･', u'•', u'~', u'-']
  repls = {}

  for i in xrange(len(cpun)):
    for j in xrange(len(cpun[i])):
      repls[cpun[i][j]] = epun[i]

  return replace_all(repls, text)

def Q2B(uchar):
  """全角转半角"""
  inside_code = ord(uchar)
  if inside_code == 0x3000:
    inside_code = 0x0020
  else:
    inside_code -= 0xfee0
  #转完之后不是半角字符返回原来的字符
  if inside_code < 0x0020 or inside_code > 0x7e:
    return uchar
  return unichr(inside_code)

def load_data(data_files):
  seq_max = 0
  seqs = []
  eos = 2
  langs = []
  raw_data = []
  lang_idx = []

  for data_file in data_files:
    with codecs.open(data_file, "r", "utf-8") as f:
      data = f.read()

    lang = re.match(r".+\/([a-z0-9]+)\.txt$", data_file).group(1)
    data = normalizeUnicodes(data)
    lines = [line for line in data.split("\n") if len(line) > 1]
    raw_data.append(lines)
    langs.append(lang)

  # Build vocab
  counter = collections.Counter("".join(["".join(data) for data in raw_data]))
  count_pairs = sorted(counter.items(), key=lambda x: -x[1])
  chars, _ = zip(*count_pairs)
  chars = START_VOCAB + list(chars)
  vocab = dict(zip(chars, range(len(chars))))

  for idx, data in enumerate(raw_data):
    for line in data:
      if len(line) <= 1:
        continue
      line = line.rstrip()
      seqs.append(line)
      lang_idx.append(idx)
      seq_max = max(seq_max, len(line))

  total_lines = len(seqs)
  seq_max += 1 # for EOS
  tensor = np.zeros((total_lines, seq_max))
  unk_idx = vocab.get(UNK)

  pbar = pb.ProgressBar(widgets=[pb.Percentage(), pb.Bar(), pb.Timer()], maxval=1).start()

  for idx2, line in enumerate(seqs):
    vec = [vocab.get(c, unk_idx) for c in line] + [eos]
    tensor[idx2, :len(vec)] = vec

    # update progressbar
    pbar.update(idx2 / float(total_lines))

  return tensor, chars, vocab, langs, lang_idx

class TextLoader(object):
  def __init__(self, data_dir, batch_size):
    self.data_dir = data_dir
    self.batch_size = batch_size

    input_files = glob.glob(data_dir + "/*.txt")
    vocab_file = os.path.join(data_dir, "vocab.pkl")
    tensor_file = os.path.join(data_dir, "data.npy")
    lang_file = os.path.join(data_dir, "lang.pkl")

    if not (os.path.exists(vocab_file) and os.path.exists(tensor_file)):
      print "reading text file"
      self.preprocess(input_files, vocab_file, tensor_file, lang_file)
    else:
      print "loading preprocessed files"
      self.load_preprocessed(vocab_file, tensor_file, lang_file)
    self.create_batches()
    self.reset_batch_pointer()

  def preprocess(self, input_files, vocab_file, tensor_file, lang_file):
    self.tensor, self.chars, self.vocabs, self.langs, self.lang_idx = load_data(input_files)
    self.vocab_size = len(self.chars)
    self.lang_size = len(self.langs)
    self.seq_length = self.tensor.shape[1]

    with codecs.open(lang_file, "wb") as f:
      cPickle.dump(self.lang_idx, f)

    with codecs.open(vocab_file, "wb") as f:
      cPickle.dump(self.chars, f)

    np.save(tensor_file, self.tensor)

  def load_preprocessed(self, vocab_file, tensor_file, lang_file):
    with codecs.open(vocab_file) as f:
      self.chars = cPickle.load(f)
    self.vocab = dict(zip(self.chars, range(len(self.chars))))

    with codecs.open(lang_file) as f:
      self.lang_idx = cPickle.load(f)

    self.langs = list(set(self.lang_idx))
    self.vocab_size = len(self.chars)
    self.lang_size = len(self.langs)
    self.tensor = np.load(tensor_file)
    self.seq_length = self.tensor.shape[1]
    self.num_batches = self.tensor.shape[0] / self.batch_size

  def create_batches(self):
    self.num_batches = self.tensor.shape[0] / self.batch_size
    self.tensor = self.tensor[:self.num_batches * self.batch_size]
    self.lang_idx = np.asarray(self.lang_idx[:self.num_batches * self.batch_size])

    # shuffle the dataset
    shuffle_idx = range(self.num_batches * self.batch_size)
    shuffle(shuffle_idx)
    xdata = []
    ydata = []
    zdata = []
    for i in shuffle_idx:
      x = self.tensor[i]
      xdata.append(x)
      y = np.copy(x)
      y[:-1] = x[1:]
      y[-1] = x[0]
      ydata.append(y)
      zdata.append(self.lang_idx[i])
    xdata = np.asarray(xdata)
    ydata = np.asarray(ydata)
    zdata = np.asarray(zdata)
    self.x_batches = np.split(xdata, self.num_batches, 0)
    self.y_batches = np.split(ydata, self.num_batches, 0)
    self.z_batches = np.split(zdata, self.num_batches, 0)
    self.x_valid = self.x_batches[-1]
    self.y_valid = self.y_batches[-1]
    self.z_valid = self.z_batches[-1]
    self.x_batches = self.x_batches[:-1]
    self.y_batches = self.y_batches[:-1]
    self.z_batches = self.z_batches[:-1]
    self.num_batches = self.num_batches - 1

  def get_valid(self):
    return self.x_valid, self.y_valid, self.z_valid

  def next_batch(self):
    x, y, z = self.x_batches[self.pointer], self.y_batches[self.pointer], self.z_batches[self.pointer]
    self.pointer += 1
    return x, y, z

  def reset_batch_pointer(self):
    self.pointer = 0
